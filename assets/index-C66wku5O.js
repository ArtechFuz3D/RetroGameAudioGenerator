(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const C={C1:32.7,"C#1":34.65,Db1:34.65,D1:36.71,"D#1":38.89,Eb1:38.89,E1:41.2,F1:43.65,"F#1":46.25,Gb1:46.25,G1:49,"G#1":51.91,Ab1:51.91,A1:55,"A#1":58.27,Bb1:58.27,B1:61.74,C2:65.41,"C#2":69.3,Db2:69.3,D2:73.42,"D#2":77.78,Eb2:77.78,E2:82.41,F2:87.31,"F#2":92.5,Gb2:92.5,G2:98,"G#2":103.83,Ab2:103.83,A2:110,"A#2":116.54,Bb2:116.54,B2:123.47,C3:130.81,"C#3":138.59,Db3:138.59,D3:146.83,"D#3":155.56,Eb3:155.56,E3:164.81,F3:174.61,"F#3":185,Gb3:185,G3:196,"G#3":207.65,Ab3:207.65,A3:220,"A#3":233.08,Bb3:233.08,B3:246.94,C4:261.63,"C#4":277.18,Db4:277.18,D4:293.66,"D#4":311.13,Eb4:311.13,E4:329.63,F4:349.23,"F#4":369.99,Gb4:369.99,G4:392,"G#4":415.3,Ab4:415.3,A4:440,"A#4":466.16,Bb4:466.16,B4:493.88,C5:523.25,"C#5":554.37,Db5:554.37,D5:587.33,"D#5":622.25,Eb5:622.25,E5:659.25,F5:698.46,"F#5":739.99,Gb5:739.99,G5:783.99,"G#5":830.61,Ab5:830.61,A5:880,"A#5":932.33,Bb5:932.33,B5:987.77,C6:1046.5,"C#6":1108.73,Db6:1108.73,D6:1174.66,"D#6":1244.51,Eb6:1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,Gb6:1479.98,G6:1567.98,"G#6":1661.22,Ab6:1661.22,A6:1760,"A#6":1864.66,Bb6:1864.66,B6:1975.53},y={dramaNotes:[{pitch:"C4",time:0,duration:.25},{pitch:"E4",time:.55,duration:.25},{pitch:"G4",time:.8,duration:.25},{pitch:"C5",time:1,duration:.25},{pitch:"A4",time:1.1,duration:.25},{pitch:"F4",time:1.25,duration:.25},{pitch:"D4",time:2.5,duration:.25},{pitch:"C#4",time:3.75,duration:.25}]},g={dramaBass:[{pitch:"C2",time:0,duration:1},{pitch:"G2",time:.5,duration:.2},{pitch:"G2",time:1,duration:.8},{pitch:"D2",time:2,duration:1},{pitch:"A2",time:3,duration:1}]};class f{constructor(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.audioContext.createGain(),this.sfxGain=this.audioContext.createGain(),this.musicGain=this.audioContext.createGain(),this.masterGain.gain.value=.7,this.sfxGain.gain.value=.8,this.musicGain.gain.value=.4,this.sfxGain.connect(this.masterGain),this.musicGain.connect(this.masterGain),this.masterGain.connect(this.audioContext.destination),this.params={jumpFreqStart:380,punchDecay:.2,coinFreqEnd:1200,explosionIntensity:1,kickFreqStart:250,powerUpFreqStart:400,laserFreqStart:800},this.isLooping=!0,this.playingSong=!1,this.songLoopTimeout=null}setMasterVolume(t){this.masterGain.gain.value=t}setSFXVolume(t){this.sfxGain.gain.value=t}setMusicVolume(t){this.musicGain.gain.value=t}resumeContext(){this.audioContext.state==="suspended"&&this.audioContext.resume()}playJump(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="square",t.frequency.setValueAtTime(this.params.jumpFreqStart,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(this.params.jumpFreqStart*1.5,this.audioContext.currentTime+.1),e.gain.setValueAtTime(.8,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.25),t.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.25)}playPunch(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain(),n=this.audioContext.createBiquadFilter();t.type="sawtooth",t.frequency.setValueAtTime(180,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(120,this.audioContext.currentTime+.05),n.type="lowpass",n.frequency.value=600,n.Q.value=5,e.gain.setValueAtTime(0,this.audioContext.currentTime),e.gain.linearRampToValueAtTime(1.5,this.audioContext.currentTime+.01),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+this.params.punchDecay),t.connect(n),n.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+this.params.punchDecay);const i=this.createNoise(.1),o=this.audioContext.createGain(),a=this.audioContext.createBiquadFilter();a.type="bandpass",a.frequency.value=300,a.Q.value=1,o.gain.setValueAtTime(0,this.audioContext.currentTime),o.gain.linearRampToValueAtTime(.8,this.audioContext.currentTime+.01),o.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),i.connect(a),a.connect(o),o.connect(this.sfxGain)}playKick(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain(),n=this.audioContext.createBiquadFilter();t.type="triangle",t.frequency.setValueAtTime(this.params.kickFreqStart||320,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(60,this.audioContext.currentTime+.1),n.type="lowpass",n.frequency.value=500,n.Q.value=2,e.gain.setValueAtTime(0,this.audioContext.currentTime),e.gain.linearRampToValueAtTime(.7,this.audioContext.currentTime+.01),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.2),t.connect(n),n.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.2);const i=this.audioContext.createOscillator(),o=this.audioContext.createGain(),a=this.audioContext.createBiquadFilter();i.type="sawtooth",i.frequency.setValueAtTime(800,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(200,this.audioContext.currentTime+.2),a.type="bandpass",a.frequency.value=500,o.gain.setValueAtTime(0,this.audioContext.currentTime),o.gain.linearRampToValueAtTime(.3,this.audioContext.currentTime+.02),o.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.15),i.connect(a),a.connect(o),o.connect(this.sfxGain),i.start(),i.stop(this.audioContext.currentTime+.15);const c=this.audioContext.createOscillator(),u=this.audioContext.createGain();c.type="sine",c.frequency.setValueAtTime(80,this.audioContext.currentTime),c.frequency.exponentialRampToValueAtTime(40,this.audioContext.currentTime+.2),u.gain.setValueAtTime(0,this.audioContext.currentTime+.02),u.gain.linearRampToValueAtTime(1,this.audioContext.currentTime+.04),u.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),c.connect(u),u.connect(this.sfxGain),c.start(),c.stop(this.audioContext.currentTime+.3)}createNoise(t){const e=this.audioContext.sampleRate*t,n=this.audioContext.createBuffer(1,e,this.audioContext.sampleRate),i=n.getChannelData(0);for(let a=0;a<e;a++)i[a]=Math.random()*2-1;const o=this.audioContext.createBufferSource();return o.buffer=n,o.start(),o.stop(this.audioContext.currentTime+t),o}playCoin(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="sine",t.frequency.setValueAtTime(900,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(this.params.coinFreqEnd,this.audioContext.currentTime+.15),e.gain.setValueAtTime(.3,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.2),t.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.2)}playPowerUp(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="square",t.frequency.setValueAtTime(this.params.powerUpFreqStart,this.audioContext.currentTime),t.frequency.linearRampToValueAtTime(this.params.powerUpFreqStart*2,this.audioContext.currentTime+.3),e.gain.setValueAtTime(.5,this.audioContext.currentTime),e.gain.linearRampToValueAtTime(.01,this.audioContext.currentTime+.35),t.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.35)}playGameOver(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="square",t.frequency.value=440,e.gain.setValueAtTime(.5,this.audioContext.currentTime),e.gain.linearRampToValueAtTime(.01,this.audioContext.currentTime+.4),t.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.4),setTimeout(()=>{const n=this.audioContext.createOscillator(),i=this.audioContext.createGain();n.type="square",n.frequency.value=220,i.gain.setValueAtTime(.5,this.audioContext.currentTime),i.gain.linearRampToValueAtTime(.01,this.audioContext.currentTime+.7),n.connect(i),i.connect(this.sfxGain),n.start(),n.stop(this.audioContext.currentTime+.7)},400)}playExplosion(){this.resumeContext();const t=this.audioContext.createBufferSource(),e=this.audioContext.createBuffer(1,this.audioContext.sampleRate*.5,this.audioContext.sampleRate),n=e.getChannelData(0);for(let a=0;a<n.length;a++)n[a]=(Math.random()*2-1)*this.params.explosionIntensity;const i=this.audioContext.createGain(),o=this.audioContext.createBiquadFilter();o.type="lowpass",o.frequency.value=200,i.gain.setValueAtTime(1.9,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.9),t.buffer=e,t.connect(o),o.connect(i),i.connect(this.sfxGain),t.start()}playLaser(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="sawtooth",t.frequency.setValueAtTime(this.params.laserFreqStart,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(this.params.laserFreqStart*.5,this.audioContext.currentTime+.2),e.gain.setValueAtTime(.6,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.25),t.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.25)}playHeal(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createOscillator(),n=this.audioContext.createGain();t.type="sine",e.type="sine",t.frequency.value=400,e.frequency.value=480,n.gain.setValueAtTime(.3,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.4),t.connect(n),e.connect(n),n.connect(this.sfxGain),t.start(),e.start(),t.stop(this.audioContext.currentTime+.4),e.stop(this.audioContext.currentTime+.4)}playAlert(){this.resumeContext();const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="triangle",t.frequency.setValueAtTime(880,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(660,this.audioContext.currentTime+.1),t.frequency.exponentialRampToValueAtTime(880,this.audioContext.currentTime+.2),e.gain.setValueAtTime(.4,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.25),t.connect(e),e.connect(this.sfxGain),t.start(),t.stop(this.audioContext.currentTime+.25)}playSong(){if(this.resumeContext(),this.playingSong)return;this.playingSong=!0,this.songStartTime=this.audioContext.currentTime;const t=y.dramaNotes,e=g.dramaBass,n=()=>this.params.jumpFreqStart===h["8bit"].jumpFreqStart?"8bit":this.params.jumpFreqStart===h.modern.jumpFreqStart?"modern":"arcade",i={"8bit":{melody:"square",bass:"triangle",melodyGain:.25,bassGain:.35},modern:{melody:"sawtooth",bass:"sine",melodyGain:.3,bassGain:.4},arcade:{melody:"square",bass:"square",melodyGain:.2,bassGain:.3}},o=n(),a=i[o],c=(u,x,l,T)=>{const d=this.audioContext.createOscillator(),p=this.audioContext.createGain();d.type=x,d.frequency.value=C[u.pitch],p.gain.setValueAtTime(l,this.songStartTime+u.time),p.gain.exponentialRampToValueAtTime(.01,this.songStartTime+u.time+u.duration),d.connect(p),p.connect(T),d.start(this.songStartTime+u.time),d.stop(this.songStartTime+u.time+u.duration)};if(t.forEach(u=>c(u,a.melody,a.melodyGain,this.musicGain)),e.forEach(u=>c(u,a.bass,a.bassGain,this.musicGain)),this.songDuration=4,this.isLooping){const u=()=>{if(!this.isLooping||!this.playingSong)return;const x=this.songStartTime+this.songDuration;this.songStartTime=x,t.forEach(l=>c(l,a.melody,a.melodyGain,this.musicGain)),e.forEach(l=>c(l,a.bass,a.bassGain,this.musicGain)),this.songLoopTimeout=setTimeout(u,(this.songDuration-.1)*1e3)};this.songLoopTimeout=setTimeout(u,(this.songDuration-.1)*1e3)}else this.songLoopTimeout=setTimeout(()=>{this.playingSong=!1},this.songDuration*1e3)}stopSong(){this.playingSong=!1,this.songLoopTimeout&&(clearTimeout(this.songLoopTimeout),this.songLoopTimeout=null)}toggleLoop(){this.isLooping=!this.isLooping,document.getElementById("loop-toggle-btn").textContent=`Loop: ${this.isLooping?"On":"Off"}`}}const s=new f;document.getElementById("jump-btn").addEventListener("click",()=>s.playJump());document.getElementById("punch-btn").addEventListener("click",()=>s.playPunch());document.getElementById("kick-btn").addEventListener("click",()=>s.playKick());document.getElementById("coin-btn").addEventListener("click",()=>s.playCoin());document.getElementById("powerup-btn").addEventListener("click",()=>s.playPowerUp());document.getElementById("gameover-btn").addEventListener("click",()=>s.playGameOver());document.getElementById("explosion-btn").addEventListener("click",()=>s.playExplosion());document.getElementById("laser-btn").addEventListener("click",()=>s.playLaser());document.getElementById("heal-btn").addEventListener("click",()=>s.playHeal());document.getElementById("alert-btn").addEventListener("click",()=>s.playAlert());document.getElementById("play-song-btn").addEventListener("click",()=>s.playSong());document.getElementById("stop-song-btn").addEventListener("click",()=>s.stopSong());document.getElementById("loop-toggle-btn").addEventListener("click",()=>s.toggleLoop());document.addEventListener("keydown",r=>{const t={Space:()=>s.playJump(),KeyP:()=>s.playPunch(),KeyK:()=>s.playKick(),KeyC:()=>s.playCoin(),KeyU:()=>s.playPowerUp(),KeyG:()=>s.playGameOver(),KeyE:()=>s.playExplosion(),KeyL:()=>s.playLaser(),KeyH:()=>s.playHeal(),KeyA:()=>s.playAlert(),KeyM:()=>s.playingSong?s.stopSong():s.playSong()};t[r.code]&&t[r.code]()});const m=(r,t,e)=>{const n=document.getElementById(r),i=document.getElementById(`${r}-value`);n.addEventListener("input",o=>{const a=parseFloat(o.target.value);i.textContent=a.toFixed(2),e(a)})};m("master-volume","masterVolume",r=>s.setMasterVolume(r));m("sfx-volume","sfxVolume",r=>s.setSFXVolume(r));m("music-volume","musicVolume",r=>s.setMusicVolume(r));m("jump-freq-start","jumpFreqStart",r=>s.params.jumpFreqStart=r);m("punch-decay","punchDecay",r=>s.params.punchDecay=r);m("coin-freq-end","coinFreqEnd",r=>s.params.coinFreqEnd=r);m("explosion-intensity","explosionIntensity",r=>s.params.explosionIntensity=r);const h={"8bit":{jumpFreqStart:380,punchDecay:.2,coinFreqEnd:1200,explosionIntensity:1},modern:{jumpFreqStart:500,punchDecay:.3,coinFreqEnd:1500,explosionIntensity:1.5},arcade:{jumpFreqStart:300,punchDecay:.15,coinFreqEnd:1e3,explosionIntensity:.8}};Object.keys(h).forEach(r=>{document.getElementById(`preset-${r}`).addEventListener("click",()=>{Object.entries(h[r]).forEach(([t,e])=>{s.params[t]=e;const n=document.getElementById(`${t.replace(/([A-Z])/g,"-$1").toLowerCase()}`),i=document.getElementById(`${t.replace(/([A-Z])/g,"-$1").toLowerCase()}-value`);n&&i&&(n.value=e,i.textContent=e.toFixed(2))})})});
